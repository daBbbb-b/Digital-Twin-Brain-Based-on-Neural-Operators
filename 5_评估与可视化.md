# 成员 E：评估与可视化负责人（刺激—功能一致性分析）

## 一、角色定位与总体目标

**成员 E 的核心职责**是：
对成员 D 反演得到的 **task 级刺激函数 ( \hat{u}(t) )** 进行**功能合理性验证**，并从**神经科学与建模两个层面**评估：

> **模型反演得到的刺激图谱，是否与真实 task 的功能激活模式一致？**

成员 E 是整个项目中**唯一直接回答“方法是否有效”**的人。

---

## 二、输入与输出一览

### 输入（来自其他成员）

1. **真实 task 的脑区级 BOLD 激活**

   * ( x_{\text{task}}(t) )，来自成员 D
2. **反演得到的刺激函数**

   * ( \hat{u}_{\text{task}}(t) )，来自成员 D
3. **脑区模板与空间信息**

   * atlas_246（脑区编号、空间位置）
4. **task 元信息**

   * task 类型（103 类）
   * subject / run / TR 信息（可选）

---

### 输出（成员 E 需交付）

1. **每个 task 的刺激图谱（空间）**
2. **刺激图谱 vs 功能激活图谱的一致性评估指标**
3. **跨 task 的统计分析与可视化结果**
4. **用于报告 / 作业的核心结论图**

---

## 三、核心评估问题（成员 E 要回答什么）

成员 E 需要系统性回答以下问题：

1. 不同 task 是否诱发**不同的刺激空间模式**？
2. 刺激图谱是否与真实功能激活区域**空间对齐**？
3. 同类 task 的刺激图谱是否**内部一致**？
4. 随机 / 错配 task 是否显著降低一致性？

---

## 四、详细任务步骤

---

### Step 1：构建 task 级功能激活图谱（Ground Reference）

从真实 BOLD 数据构造 **task 功能激活模式**：

#### 常见做法（任选其一）

* task 时间窗内：

  * 时间平均激活
  * peak activation
* 或：

  * 与 baseline 对比的 activation contrast

**输出形式**：

```text
A_task ∈ R^{246}
```

> 注意：这不是统计意义上的 GLM，只是用于一致性比较的功能模式。

---

### Step 2：构建 task 级刺激图谱

从反演刺激 ( \hat{u}(t) ) 中提取空间模式：

#### 常见方式

* 时间平均：
$$
  [
  U_{\text{task}} = \frac{1}{T} \sum_t \hat{u}(t)
  ]
$$
* 最大响应：
$$
\max_t \hat{u}(t)
$$
* 多尺度刺激（如有）：

  * 神经递质尺度
  * 发放率尺度

**输出形式**：

```text
U_task ∈ R^{246}
```

---

### Step 3：刺激–功能一致性度量（核心评估）

对每个 task，计算：

#### 空间一致性指标

* Pearson correlation
* Spearman rank correlation
* Cosine similarity
* Top-k overlap（高激活脑区重合度）

#### 示例

```text
score_task = corr(U_task, A_task)
```

---

## 八、刺激图谱与功能图谱的直观解释

为了帮助理解“刺激图谱”和“功能图谱”的区别与联系，这里提供一个具体的例子。

### 一、真实功能图谱（Functional Activation Map）

1️⃣ **来源**：从真实 BOLD 数据计算得到。

假设我们使用 246 脑区（BNA atlas），针对一个视觉任务（visual task），从 fMRI 数据中提取激活模式。具体步骤如下：

- **输入数据**：BOLD 时间序列 \( x(t) \in \mathbb{R}^{246} \)，时间长度为 280 个时间点（TR = 2s，总时间 = 560s）。
- **任务事件**：从 `events.tsv` 文件中提取任务时间窗，例如：
  ```
  task    onset   duration
  visual  20s     20s
  visual  60s     20s
  ```
- **计算激活图谱**：对任务时间窗内的 BOLD 信号取均值，并减去非任务时间窗的均值：
$$
\text{FuncMap}(k) = \mathbb{E}[x(t) \mid \text{task on}] - \mathbb{E}[x(t) \mid \text{task off}]

$$

2️⃣ **输出形式**：得到任务相关的功能激活图谱 
$$\text{FuncMap}(k) \in \mathbb{R}^{246} 
$$
3️⃣ **数字化例子**（截取 10 个脑区）：
   | 脑区 | 激活值 |
   |------|--------|
   | V1   | 2.3    |
   | V2   | 2.1    |
   | V3   | 1.9    |
   | MT   | 1.7    |
   | IT   | 1.2    |
   | M1   | 0.1    |
   | SMA  | 0.0    |
   | ACC  | -0.1   |
   | PFC  | 0.2    |
   | PCC  | 0.0    |

📌 **含义**：这个任务主要激活了视觉皮层相关脑区。

---

### 二、刺激图谱（Stimulus Map）

1️⃣ **来源**：从模型反演得到的刺激时间序列 $$
 \hat{u}(t) \in \mathbb{R}^{246} $$ 中提取空间模式。

2️⃣ **计算方法**：与功能图谱类似，对任务时间窗内的反演刺激信号取均值，并减去非任务时间窗的均值：
   $$
   \text{StimMap}(k) = \mathbb{E}[\hat{u}(t) \mid \text{task on}] - \mathbb{E}[\hat{u}(t) \mid \text{task off}]
   $$

3️⃣ **输出形式**：得到任务相关的刺激图谱 
$$
 \text{StimMap}(k) \in \mathbb{R}^{246} 。
$$
4️⃣ **数字化例子**（同样截取 10 个脑区）：
   | 脑区 | 刺激强度 |
   |------|----------|
   | V1   | 2.5      |
   | V2   | 2.2      |
   | V3   | 2.0      |
   | MT   | 1.6      |
   | IT   | 1.1      |
   | M1   | 0.0      |
   | SMA  | -0.1     |
   | ACC  | 0.0      |
   | PFC  | 0.3      |
   | PCC  | 0.1      |

📌 **含义**：为了产生观测到的激活，模型认为刺激主要“打在”视觉皮层。

---

### 三、刺激图谱与功能图谱的一致性分析

1️⃣ **对比目标**：比较刺激图谱 \( \text{StimMap}(k) \) 和功能图谱 \( \text{FuncMap}(k) \) 的空间模式，而非逐点数值相等。

2️⃣ **常用指标**：
   - Pearson 相关性：
     $$
     r = \text{corr}(\text{StimMap}(k), \text{FuncMap}(k))
     $$
   - 示例：在上述例子中，相关性 \( r \approx 0.92 \)（非常高）。

3️⃣ **随机对照**：与随机刺激图谱对比，随机刺激的相关性通常接近 0。例如：
   | 脑区 | 随机刺激 |
   |------|----------|
   | V1   | 0.1      |
   | V2   | -0.3     |
   | M1   | 1.2      |
   | ACC  | -0.8     |
   | PFC  | 0.6      |

   随机刺激与功能图谱的相关性 \( r \approx 0.05 \)。

📌 **结论**：高相关性表明模型反演的刺激图谱与真实功能图谱在空间分布上高度一致，证明方法有效。

---

### 四、刺激图谱与功能图谱的区别

| 项目         | 刺激图谱             | 功能图谱             |
|--------------|----------------------|----------------------|
| **来源**     | 模型反演             | 真实 BOLD            |
| **含义**     | 外源驱动位置         | 实际被激活位置       |
| **是否观测** | 否（隐变量）         | 是                   |
| **作业地位** | 核心结果             | 对照标准             |

---

### 五、终极理解

- **功能图谱回答的是**：发生了什么。
- **刺激图谱回答的是**：为什么会发生。

这正是本项目的核心目标。

---

## 五、关键解释责任（写报告时）

成员 E 需要在报告中清楚说明：

### 1️⃣ 为什么刺激不是 BOLD 的“复刻”

* BOLD = 动力学系统输出
* 刺激 = 系统的驱动项
* 空间一致 ≠ 数值相同

---

### 2️⃣ 一致性 ≠ 完美重合

* 存在血流动力学模糊
* 存在网络扩散效应
* 局部刺激 → 全局响应

---

## 六、成员 E 的最终交付清单

✔ 每个 task 的刺激空间图谱
✔ 刺激–功能一致性量化结果
✔ 跨 task 的统计结论
✔ 课程作业 / 汇报用关键图表

---

## 七、一句话总结成员 E 的角色

> **成员 E 是整个项目的“裁判”：
> 用功能一致性证明，你们构建的数字大脑不是在“胡编刺激”。**

---

如果你愿意，下一步我可以帮你：

* 把 **A–E 五个成员的任务合并成一页“项目执行路线图”**
* 或直接帮你写 **作业报告中“实验设计与验证方法”那一章**
